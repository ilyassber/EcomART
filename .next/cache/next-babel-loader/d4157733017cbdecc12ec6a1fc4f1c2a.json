{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport { parseCookies } from '../../lib/parseCookies';\nimport { Navbar, WelcomeBar } from '../../components/elements/bar';\nimport ArticleList from '../../components/elements/list/ArticleList';\nimport { postRequest } from '../../services/api/post/postRequest';\nimport ArticleBanner from '../../components/widgets/article/ArticleBanner';\nimport querystring from 'querystring';\nimport { getRequest } from '../../services/api/get/getRequest';\nimport Layout from '../../components/layout';\n\nvar Stories = function Stories(props) {\n  console.log(props.cookies);\n  console.log(props.data);\n\n  var _useState = useState(null),\n      data = _useState[0],\n      setData = _useState[1];\n\n  var _useState2 = useState(false),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  useEffect(function () {\n    console.log('useEffect runs');\n    setIsLoading(true);\n    postRequest(querystring.stringify({\n      operation: \"all\"\n    }), props.cookies['csrftoken'], process.env.domain + '/api/articles/').then(function (res) {\n      console.log(res);\n      setData(JSON.stringify(res));\n      setIsLoading(false);\n    });\n  }, []);\n  var body = null;\n\n  if (!isLoading) {\n    var articlesList = data ? JSON.parse(data).map(function (article) {\n      return __jsx(ArticleBanner, {\n        className: \"h-auto w-full max-w-screen-md m-4\",\n        key: article.id,\n        data: article\n      });\n    }) : null;\n\n    var articles = __jsx(ArticleList, {\n      className: \"w-full p-2\",\n      data: articlesList\n    });\n\n    body = __jsx(\"div\", {\n      className: \"w-full flex flex-col items-center\"\n    }, articles);\n  } else if (!isLoading && (!data || data.length === 0)) {\n    body = null;\n  }\n\n  var content = __jsx(Layout, {\n    tags: props.tags\n  }, body);\n\n  return content;\n};\n\nStories.getInitialProps = function _callee(_ref) {\n  var req, cookies, tags;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          req = _ref.req;\n          cookies = parseCookies(req);\n          _context.next = 4;\n          return _regeneratorRuntime.awrap(getRequest(process.env.domain + '/api/categories/').then(function (res) {\n            return res;\n          }));\n\n        case 4:\n          tags = _context.sent;\n          return _context.abrupt(\"return\", {\n            cookies: cookies,\n            tags: tags\n          });\n\n        case 6:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nexport default Stories;","map":null,"metadata":{},"sourceType":"module"}