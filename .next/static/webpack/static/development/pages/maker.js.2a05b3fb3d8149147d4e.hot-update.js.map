{"version":3,"file":"static/webpack/static\\development\\pages\\maker.js.2a05b3fb3d8149147d4e.hot-update.js","sources":["webpack:///./components/elements/article/AddArticle.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { TxtField, TxtArea } from '../../graphics/textFields'\r\nimport { BtnBbw } from '../../graphics/buttons'\r\nimport { uploadImage } from '../../../services/api/uploadImage'\r\nimport { AddContent } from '../../widgets/article'\r\nimport AddSingleImage from '../../widgets/image/AddSingleImage'\r\nimport AddText from '../../widgets/article/AddText'\r\nimport querystring from 'querystring'\r\nimport { postRequest } from '../../../services/api/post/postRequest'\r\n\r\nconst AddArticle = props => {\r\n\r\n    const [data, setData] = useState({\r\n        title: null,\r\n        description: null,\r\n        cover: {\r\n            state: \"edit\",\r\n            data: {\r\n                type: \"image\",\r\n                image: null\r\n            }\r\n        },\r\n        text: []\r\n    })\r\n\r\n    const getValue = (event, access) => {\r\n        if (access == 'title') {\r\n            setData({ ...data, title: event.target.value })\r\n        } else if (access == 'description') {\r\n            setData({ ...data, description: event.target.value })\r\n        }\r\n    }\r\n\r\n    const addCover = (file) => {\r\n        setData({ ...data, cover: file })\r\n    }\r\n\r\n    const removeCover = () => {\r\n        setData({ ...data, cover: null })\r\n    }\r\n\r\n    const appendContent = (content) => {\r\n        let contentList = data.text\r\n        contentList.push(content)\r\n        setData({ ...data, text: contentList })\r\n    }\r\n\r\n    const editContent = (index, content) => {\r\n        let contentList = data.text\r\n        contentList[index] = content\r\n        setData({ ...data, text: contentList })\r\n    }\r\n\r\n    const removeContent = (index) => {\r\n        let contentList = data.text\r\n        contentList.splice(index, 1)\r\n        setData({ ...data, text: contentList })\r\n    }\r\n\r\n    const editCoverContent = (index, content) => {\r\n        setData({ ...data, cover: content })\r\n    }\r\n\r\n    const handleSubmit = async (event) => {\r\n        event.preventDefault()\r\n        let coverId = await uploadImage(event, data.cover.data.image, props.cookies['csrftoken']).then((res) => res.data)\r\n        let textList = []\r\n        for (let i = 0; i < data.text.length; i++) {\r\n            if (data.text[i].data.type == 'image') {\r\n                let response = await uploadImage(event, data.text[i].data.image, props.cookies['csrftoken']).then((res) => res)\r\n                textList.push(querystring.stringify({\r\n                    type: 'image',\r\n                    image: response.data\r\n                }))\r\n            } else {\r\n                textList.push(querystring.stringify({\r\n                    type: 'text',\r\n                    text:  data.text[i].data.text\r\n                }))\r\n            }\r\n        }\r\n        let newData = {\r\n            ...data,\r\n            cover: coverId,\r\n            text: querystring.stringify(textList)\r\n        }\r\n        postRequest(querystring.stringify(newData), props.cookies['csrftoken'], 'http://localhost:8000/articles/').then((res) => {\r\n            console.log(res)\r\n        })\r\n    }\r\n\r\n    let content = (\r\n        <div className=\"m-4\">\r\n            <form className=\"w-full\" action=\"\">\r\n                <TxtField label=\"Title\" onChange={(event) => getValue(event, 'title')} />\r\n                <TxtArea label=\"Description\" onChange={(event) => getValue(event, 'description')} />\r\n                <div className=\"pb-2\">\r\n                    <label className=\"block mb-1 font-sans font-medium\">Add Cover</label>\r\n                    <AddSingleImage index={-1} className=\"\" data={data.cover} close=\"false\" editContent={editCoverContent} removeContent={() => { }} />\r\n                </div>\r\n                <div>\r\n                    <label className=\"block mb-1 font-sans font-medium\">Add Article Content</label>\r\n                    <div className=\"h-auto w-full border\">\r\n                        {data.text.map((content, index) => {\r\n                            if (content.data.type == \"image\") {\r\n                                return (<AddSingleImage index={index} className=\"m-2\" data={content} close=\"true\" editContent={editContent} removeContent={removeContent} />)\r\n                            } else {\r\n                                return (<AddText index={index} className=\"m-2\" data={content} editContent={editContent} removeContent={removeContent} />)\r\n                            }\r\n                        })}\r\n                        <AddContent className=\"m-2\" appendContent={appendContent} />\r\n                    </div>\r\n                </div>\r\n                <BtnBbw className=\"w-full h-12 mt-8 mb-4\" value=\"ADD ARTICLE\" onClick={handleSubmit} />\r\n            </form>\r\n        </div>\r\n    )\r\n\r\n    return content\r\n}\r\n\r\nexport default AddArticle"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAOA;AAVA;AAFA;AAAA;AACA;AAcA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAEA;AAAA;AACA;AAHA;AAEA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAMA;AAAA;AACA;AAPA;AAMA;AACA;AACA;AACA;AAFA;AAPA;AAAA;AACA;AADA;AAYA;AACA;AACA;AAFA;AACA;AAbA;AAIA;AAJA;AAAA;AACA;AADA;AAkBA;AAEA;AACA;AArBA;AAuBA;AACA;AACA;AACA;AA1BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AA2BA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAIA;AACA;AACA;AACA;;;;A","sourceRoot":""}